<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nudge Creative Studio</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <!-- Header -->
    <header>
        <!-- Left: Company Logo and Dropdown -->
        <div class="logo-bar" id="company-bar">
            <img src="{{ url_for('static', filename='my-logo.png') }}" alt="Company Logo" class="logo-img company-logo" />
            <div class="toggle-options left-options" id="company-options">
                <ul>
                    <li><a href="#">Dashboard</a></li>
                    <li><a href="#">Docs</a></li>
                    <li><a href="#">Contact</a></li>
                </ul>
            </div>
        </div>
    
        <!-- Right: Client Logo and Dropdown -->
        <div class="toggle-bar" id="client-bar">
            <img src="{{ url_for('static', filename='client-logo/' + session.get('client-logo', 'default-logo.png')) }}" alt="Client Logo" class="logo-img client-logo" />
            <div class="toggle-options right-options" id="client-options">
                <ul>
                    <li><a href="#">My Account</a></li>
                    <li><a href="#">Settings</a></li>
                    <li><a href="#">Plan</a></li>
                    <li><a href="{{ url_for('logout') }}">Log Out</a></li> <!-- ← Add this line -->
                </ul>
            </div>
        </div>
    </header>
    

    <!-- Main Content -->
    <main>
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="flash-message {{ category }}">{{ message }}</div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <div class="container">
            <form method="POST" enctype="multipart/form-data">
                <div class="upload-container" id="upload-box">
                    <input type="file" id="file-upload" class="file-upload" name="pdf_file" accept=".pdf" required hidden />
                    <p>Drag and drop files here, or click to select</p>
                </div>

                <div class="button-container">
                    <button type="submit" id="process-button">Make Magic</button>
                </div>
            </form>                           
        </div>
    </main>

    <script src="{{ url_for('static', filename='script.js') }}"></script>

    <script>
        // Existing dropdown toggle logic
        document.addEventListener("DOMContentLoaded", () => {
            const companyBar = document.getElementById("company-bar");
            const clientBar = document.getElementById("client-bar");

            // Toggle Company Dropdown
            companyBar.addEventListener("click", (e) => {
                e.stopPropagation();
                companyBar.classList.toggle("active");
                clientBar.classList.remove("active");
            });

            // Toggle Client Dropdown
            clientBar.addEventListener("click", (e) => {
                e.stopPropagation();
                clientBar.classList.toggle("active");
                companyBar.classList.remove("active");
            });

            // Close dropdowns if clicking outside
            document.addEventListener("click", () => {
                companyBar.classList.remove("active");
                clientBar.classList.remove("active");
            });

            // ✅ NEW: Prevent double form submission
            const form = document.querySelector("form");
            let submitting = false;

            form.addEventListener("submit", (e) => {
                if (submitting) {
                    e.preventDefault();
                    return false;
                }
                submitting = true;
            });
        });
    </script>

</body>
</html>
